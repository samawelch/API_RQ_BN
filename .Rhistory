library(tidyverse)
library(readxl)
full_products <- read_xlsx(path = "t_Product_API.xlsx", sheet = 1)
View(full_products)
full_products <- read_xlsx(path = "t_Product_API.xlsx", sheet = 1)
unitless_relevant <- read_xlsx(path = "t_Product_API.xlsx", sheet = 2)
View(unitless_relevant)
full_products <- full_products %>%
filter(ProductCode %in% unitless_relevant$ProductCode,
API_name %in% unitless_relevant$API_Name)
full_products <- read_xlsx(path = "t_Product_API.xlsx", sheet = 1)
unitless_relevant <- read_xlsx(path = "t_Product_API.xlsx", sheet = 2)
full_products <- full_products %>%
filter(ProductCode %in% unitless_relevant$ProductCode,
API_name %in% unitless_relevant$API_Name) %>%
left_join(y = select(unitless_relevant, ProductName))
full_products <- read_xlsx(path = "t_Product_API.xlsx", sheet = 1)
unitless_relevant <- read_xlsx(path = "t_Product_API.xlsx", sheet = 2)
full_products <- full_products %>%
filter(ProductCode %in% unitless_relevant$ProductCode,
API_name %in% unitless_relevant$API_Name) %>%
left_join(y = select(unitless_relevant, ProductName, ProductCode))
write_excel_csv(full_products, file = "unitless_products_final.csv")
write_excel_csv(full_products, file = "unitless_products_final.csv", na = "")
knitr::opts_chunk$set(echo = TRUE)
# Load required packages
library(tidyverse) # manipulate data and produce graphs
library(readxl) # read excel format files
library(webchem) # match substances to InChiKeys
library(treemapify) # draw treemaps in ggplot2
library(ggrepel) # better labelling of points in ggplot
library(gridExtra) # better multi-graphic layouts
library(blandr)
#########################
### Authors' Database ###
#########################
### Read data from processed database
## NB: In the uploaded version this file is removed. Please
## replace the file name with: t850_Sales_Product_API_20210913_1200_Censored
sales_by_API_year <- read_xlsx(path = "Data/Db/t830_Product_API_sold_per_year.xlsx")
getwd()
" "
library(glmm)
library(MASS)
library(lme4)
library(tidyverse)
library(readxl)
library(glmm)
fit <- lmer(log(Sales_Weight_g) ~ -1 + API + (1 | x.year), data = estrogen_example_data)
# Import Data
setwd("C:/Users/burne/OneDrive - NIVA/Projects/Papers/03_Bayesian_Mixture_Toxicity/")
estrogen_example_data <- read_xlsx("Data/Example_Estrogen_Sales.xlsx")
fit <- lmer(log(Sales_Weight_g) ~ -1 + API + (1 | x.year), data = estrogen_example_data)
fit <- lmer(log(Sales_Weight_g) ~ -1 + API + (1 | Year), data = estrogen_example_data)
fit
summary(fit)
exp(summary(fit)$coef[,"Estimate"])
plot(fit)
plot(fit$APIethinylestradiol)
stderr()
?stderr()
View(fit)
test <- summary(fit)
View(test)
summary(fit)
(0.1901 * sqrt(5)) ^ 2
library(tidyverse)
library(lme4)
library(readxl)
library(drc)
# Set wd to project folder
knitr::opts_knit$set(root.dir = rprojroot::find_rstudio_root_file())
# Import Data
setwd("C:/Users/burne/OneDrive - NIVA/Projects/Papers/03_Bayesian_Mixture_Toxicity/")
estrogen_example_data <- read_xlsx("Data/Example_Estrogen_Sales.xlsx")
library(MASS)
library(lme4)
library(tidyverse)
library(readxl)
library(glmm)
install.packages("glmm")
library(MASS)
library(lme4)
library(tidyverse)
library(readxl)
library(glmm)
# Import Data
setwd("C:/Users/burne/OneDrive - NIVA/Projects/Papers/03_Bayesian_Mixture_Toxicity/")
estrogen_example_data <- read_xlsx("Data/Example_Estrogen_Sales.xlsx")
getwd()
estrogen_example_data <- read_xlsx("Data/Example_Estrogen_Sales.xlsx")
library(fitdistrplus)
bad_lnd_estradiol <- fitdist(estrogen_example_data$Sales_Weight_g, "lnorm")
summary(bad_lnd_estradiol)
plot(bad_lnd_estradiol)
summary(bad_lnd_estradiol)
fit <- lmer(log(Sales_Weight_g) ~ -1 + API + (1 | Year), data = estrogen_example_data)
summary(fit)
exp(summary(fit)$coef[,"Estimate"])
library(drc)
?drc
library(drc)
weibull1(fixed = c(0.044, -0.75, NA, 1.05))
test <- weibull1(fixed = c(0.044, -0.75, NA, 1.05))
plot(test)
View(test)
## Model fit to simulate from
ryegrass.m1 <- drm(rootl~conc, data = ryegrass, fct = LL.4())
## 10 random dose-response curves based on the model fit
sim10a <- rdrm(10, LL.4(), coef(ryegrass.m1), xerror = ryegrass$conc)
sim10a
plot(ryegrass.m1)
?earthworms
#import dataset
EW<-earthworms()
EW<-data(earthworms)
# print data #
EW
head(EW)
data(earthworms)
data(earthworms)
earthworms
earthworms()
EW<-earthworms
EW
head(EW)
plot(EW$dose,EW$number/EW$total)
EW.ll4<-drm(number/total~dose, type="binomial",weight=total, data=EW, fct=LL.4())
plot(EW.ll4, type="all")
EW.ll3<-update(EW.ll4, fct=LL.3())
plot(EW.ll3, type="all")
anova(EW.ll2,EW.ll3)
EW.ll2<-update(EW.ll3, fct=LL.2())
plot(EW.ll2, type="all")
anova(EW.ll2,EW.ll3)
ED(EW.ll3,c(10,25,50), interval="delta")
mselect(EW.ll3, list( W1.3(), W2.3(), LN.3()))
setwd("C:/Users/burne/OneDrive - NIVA/Projects/Papers/03_Bayesian_Mixture_Toxicity/")
estrogen_example_data <- read_xlsx("Data/Example_Estrogen_Sales.xlsx")
library(MASS)
library(lme4)
library(tidyverse)
library(readxl)
library(glmm)
estrogen_example_data <- read_xlsx("Data/Example_Estrogen_Sales.xlsx")
fit <- lmer(log(Sales_Weight_g) ~ -1 + API + (1 | Year), data = estrogen_example_data)
summary(fit)
exp(summary(fit)$coef[,"Estimate"])
